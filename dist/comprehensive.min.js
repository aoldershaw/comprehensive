"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var j=/^for\s+([A-Za-z_\$][A-Za-z0-9-_\$]*(\s*,\s*[A-Za-z_\$][A-Za-z0-9-_\$]*)*)\s+of/,t=/^[A-Za-z_$][A-Za-z0-9-_$]*(?:\.[A-Za-z_$][A-Za-z0-9-_$]*)*/;function O(r,e){for(var t=e,n=0,o=r.expr.split(".");n<o.length;n++){if(void 0===(t=t[o[n]]))return t}return t}function I(r){return"function"==typeof r}function M(r){var e=t.exec(r);if(null==e)throw new Error("Invalid reference format");return{expr:e[0]}}function n(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var n,o,i,a=(n=r[0].trim(),o="{",n.replace(new RegExp("^"+o+"+"),"")).trim(),f=0,l=1,u=0===a.length;if(u){if(null==(i=e[f++]))throw new Error("Expecting a key");a=r[l++].trim()}else i=M(a),a=a.substr(i.expr.length).trim();if(":"!==a.charAt(0))throw new Error("Missing ':'");var s,p=0===(a=a.substr(1).trim()).length;if(p){if(!(s=e[f++]))throw new Error("Expecting a value");a=r[l++].trim()}else s=M(a),a=a.substr(s.expr.length).trim();var v,h,c,g,w,d,y=function(r){var e;if("over"===r.substr(0,4))return["it"];if(null!=(e=j.exec(r)))return e[1].split(",").map(function(r){return r.trim()});throw new Error("Invalid iteration operator. Expecting either 'for ... of' or 'over', provided "+r)}(a),A=1<y.length,m={},x={},E=e[f];if(null==E||!Array.isArray(E))throw new Error("An invalid array was passed (provided "+E+")");for(var b=0,_=E;b<_.length;b++){var z=_[b];if(A){if(null==z||!Array.isArray(z)||z.length!==y.length)throw new Error("Cannot spread value "+z+" into fields ["+y.join(", ")+"]");for(var Z=0;Z<y.length;Z++)x[y[Z]]=z[Z]}else x[y[0]]=z;var $=(g=i,w=z,d=x,!u?O(g,d):I(g)?g(w):g);if("string"!=typeof $&&"number"!=typeof $)throw new Error("Key must be either a string or a number, not a(n) "+typeof $);m[$]=(v=s,h=z,c=x,!p?O(v,c):I(v)?v(h):v)}return m}exports.toObj=n,exports.toObjSafe=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];try{return n.apply(void 0,[r].concat(e))}catch(r){return null}};
