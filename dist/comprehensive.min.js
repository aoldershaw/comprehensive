"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var A=/^for\s+([A-Za-z_\$][A-Za-z0-9-_\$]*(\s*,\s*[A-Za-z_\$][A-Za-z0-9-_\$]*)*)\s+of/,e=/^[A-Za-z_$][A-Za-z0-9-_$]*(?:\.[A-Za-z_$][A-Za-z0-9-_$]*)*/;function E(r,t,e){return t?function(n,r){var o=r.indexOf(n.parts[0]);if(o<0)throw new Error("Invalid field name "+n.parts[0]);var i=1<r.length;return function(r){for(var t=i?r[o]:r,e=1;e<n.parts.length;e++)if(void 0===(t=t[n.parts[e]]))return t;return t}}(r,e):"function"==typeof r?r:function(){return r}}function b(r){var t=e.exec(r);if(null==t)throw new Error("Invalid reference format");return{parts:t[0].split("."),expr:t[0]}}function n(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var n,o,i,a=(n=r[0].trim(),o="{",n.replace(new RegExp("^"+o+"+"),"")).trim(),f=0,u=1,s=0===a.length;if(s){if(null==(i=t[f++]))throw new Error("Expecting a key");a=r[u++].trim()}else i=b(a),a=a.substr(i.expr.length).trim();if(":"!==a.charAt(0))throw new Error("Missing ':'");var l,p=0===(a=a.substr(1).trim()).length;if(p){if(!(l=t[f++]))throw new Error("Expecting a value");a=r[u++].trim()}else l=b(a),a=a.substr(l.expr.length).trim();var v=function(r){var t;if("over"===r.substr(0,4))return["it"];if(null!=(t=A.exec(r)))return t[1].split(",").map(function(r){return r.trim()});throw new Error("Invalid iteration operator. Expecting either 'for ... of' or 'over', provided "+r)}(a),c=E(i,!s,v),h=E(l,!p,v),w={},g=t[f];if(null==g||!Array.isArray(g))throw new Error("An invalid array was passed (provided "+g+")");for(var d=0,m=g;d<m.length;d++){var x=m[d],y=c(x);if("string"!=typeof y&&"number"!=typeof y)throw new Error("Key must be either a string or a number, not a(n) "+typeof y);w[y]=h(x)}return w}exports.toObj=n,exports.toObjSafe=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];try{return n.apply(void 0,[r].concat(t))}catch(r){return null}};
